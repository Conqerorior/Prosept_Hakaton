<p align="center">
  <img src="https://prosept.ru/images/prosept-logo.svg" />
</p>

[**PROSEPT.RU**](#https://prosept.ru/)



# Описание проекта

Заказчик производит несколько сотен различных товаров бытовой и промышленной
химии, а затем продаёт эти товары через дилеров. Дилеры, в свою очередь,
занимаются розничной продажей товаров в крупных сетях магазинов и на онлайн
площадках.Для оценки ситуации, управления ценами и бизнесом в целом, заказчик
периодически собирает информацию о том, как дилеры продают их товар. Для этого
они парсят сайты дилеров, а затем сопоставляют товары и цены.
Зачастую описание товаров на сайтах дилеров отличаются от того описания, что
даёт заказчик.

Цель этого проекта - разработка решения, которое отчасти автоматизирует процесс
сопоставления товаров. Основная идея - предлагать несколько товаров заказчика,
которые с наибольшей вероятностью соответствуют размечаемому товару дилера.
Предлагается реализовать это решение, как онлайн сервис, открываемый в веб-
браузере. Выбор наиболее вероятных подсказок делается методами машинного
обучения.

# Работа Приложения

В основном файле представленны функции по обучению модели и предсказанию. В
функции обучения модели данные
векторизовались с помощью метода **tf-idf**. До этого данные подверглись
изменениям. В названии товаров изначально были
неаккуратно склеены слова. Так были склеены между собой слова на латинице и
кириллице, числа и слова, слова в разных
регистрах. С помощью созданной функции их получилось разделить. Затем удалили
знаки препинания, произвелась
токкенизация, лемматизация и стемм. Затем строилась матрица евклидовых
расстояний с помощью инструмента
**scipy.spatial.distance.cdist**, которые затем сортировались.
Данные при этом были почищены. Из данных производителя были удалены 2 строки с
пропусками в названии, а из данных
от диллеров только для обучения были удаленны товары с отсутствующим ключом id к
данным производителя. 

Для тестирования
и предсказания данные от диллера не удалялись.
К матрице остортированных расстояний добавился **target**. На месте верных id в
матрице расстояний проставили 1,в остальных
случаях 0. Таким образом, предсказываемой переменной стал номер столбца верного
id или номер столбца при котором стоит 1.
Матрица расстояний подавалась на вход модели **LGBM** с мультиклассовой
классификацией. Таким образом получились вероятности,
которые были отсортированны для каждой карточки диллера. 

Были выбраны 5 карточек
наиболее вероятных карточек производителя
для каждой карточки диллера. На данных, в которых были удаленны неразмеченные
карточки диллеров, метрика вышла **97%**. На
изначальных данных - **84%**. Тест производился на отдельной выборке.
В общую функцию для обучения подаются три или четыре списка словарей. Данные
производителя, данные диллеров,
на которых модель может обучиться (в нашем случае, те данные от диллеров,
которые были даны), данные с внешними ключами и
данные для предсказания. Последний список по умолчанию является тем же списком
от дилеров, что и для обучения, но можно
ввести другие данные для предсказания.

Функция возвращает список словарей, в котором каждый список (каждая карточка от
дилера) представлен 5 id.

# Документация API

[fastapi_proseptdealer/api/docs](https://clownvkkaschenko.github.io/ReferralSystem/)

# Авторы:

- **[Kristina](https://t.me/kr1588)**
- **[Julia](https://t.me/Jshmatova)**
- **[Александр](https://t.me/AlexXramov)**
